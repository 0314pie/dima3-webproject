
<!DOCTYPE html>
<html xmlns:th= "http://www.thymeleaf.org"
	  xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>게시글 보기 화면</title>

    <!--font-->
    <link href='//spoqa.github.io/spoqa-han-sans/css/SpoqaHanSansNeo.css' rel='stylesheet' type='text/css'>

    <!--css-->
    <link th:href="@{/assets/css/bootstrap.min.css}" rel="stylesheet" />
    <link th:href="@{/assets/css/ccaDetail.css}" rel="stylesheet" />
    
    <script th:src="@{/script/jquery-3.7.1.min.js}"></script>
    <script th:inline="javascript" th:src="@{/script/detail.js}"></script>
</head>

<body>
	<!-- Ajax 전송 시 필요  -->
	<input type="hidden" id="consultNum" th:value="${consult.consultNum}">
	<input type="hidden" id="contextPath" th:value="${contextPath}">

	<!-- Navbar -->
    <nav class="navbar navbar-expand-lg fixed-top navbar-transparent " color-on-scroll="300">
        <div class="container">
            <div class="navbar-translate">
                <a class="navbar-brand" th:href="@{/}" rel="tooltip" title="Coded by Creative Tim" data-placement="bottom">
                    <img th:src="@{/images/web-logo9.png}" alt="로고">
                </a>
            </div>
            <div class="collapse navbar-collapse justify-content-end" id="navigation">
                <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link" rel="tooltip" data-placement="bottom" th:href="@{/news}">
                    무역뉴스
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" rel="tooltip" data-placement="bottom" th:href="@{/info/infoList}">
                    FTA정보
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" rel="tooltip" data-placement="bottom" th:href="@{/trade/showStat}">
                    무역통계
                    </a>
                </li>

                <div class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" data-toggle="dropdown" id="dropdownMenuButton" href="#" role="button" aria-haspopup="true" aria-expanded="false">관세사상담</a>
                    <ul class="dropdown-menu dropdown-info" aria-labelledby="dropdownMenuButton">
                        <a class="dropdown-item" th:href="@{/cca/ccaList}">관세사목록</a>
                        <a class="dropdown-item" th:href="@{/cca/boardList}">상담목록</a>
                        <a class="dropdown-item" th:href="@{/cca/ccaWrite}">상담하기</a>
                    </ul>
                </div>
                </ul>
            </div>
        </div>    
    </nav>
    <!-- End Navbar -->

    <!-- page-header 시작-->
    <div class="page-header section-dark" th:style="'background-image: url(\'' + @{/images/cover-img1.jpg} + '\')'">
        <div class="filter"></div>
    </div>
    <!-- End page-header -->
    
    <!-- side-bar 시작-->
    <nav class="main-menu">
        <div class="settings"></div>
        <div class="scrollbar" id="style-1">
            <ul>
                <li class="menu-img">
                    <a href="#">
                        <i class="fa fa-solid fa-bars fa-lg"></i>
                        <span class="nav-text">Menu</span>
                    </a>
                </li> 
                <li>                                 
                    <a th:href="@{/news}">
                        <i class="fa fa-solid fa-newspaper fa-lg"></i>
                        <span class="nav-text">무역뉴스</span>
                    </a>
                </li>
                <li>                                 
                    <a th:href="@{/info/infoList}">
                        <i class="fa fa-solid fa-book fa-lg"></i>
                        <span class="nav-text">FTA정보</span>
                    </a>
                </li>
                <li>                                 
                    <a th:href="@{/trade/showStat}">
                        <i class="fa fa-solid fa-chart-simple fa-lg"></i>
                        <span class="nav-text">무역통계</span>
                    </a>
                </li>
                <li>                                 
                    <a th:href="@{/cca/boardList}">
                        <i class="fa fa-solid fa-handshake fa-lg"></i>
                        <span class="nav-text">관세사상담</span>
                    </a>
                </li>
                <li>                                 
                    <a th:href="@{/user/login}">
                        <i class="fa fa-regular fa-user fa-lg"></i>
                        <span class="nav-text">로그인</span>
                    </a>
                </li>
                <li>
                    <a th:href="@{/user/logout}">
                        <i class="fa fa-user fa-lg"></i>
                        <span class="nav-text">로그아웃</span>
                    </a>
                </li>
                <li>                                 
                    <a href="#">
                        <i class="fa fa-solid fa-house-user fa-lg"></i>
                        <span class="nav-text">마이페이지</span>
                    </a>
                </li>
            </ul>
        </div>    
        </div>
    </nav>

    <!-- 글보기 -->
    <div class="content">
            <table border="1">
                <tr>
                    <th>작성자</th>
                    <td>
                    	<span th:text="${consult.consultWriter}">작성자</span>
                    </td>
                </tr>
                <tr>
                    <th>글제목</th>
                    <td>
                    	<span th:text="${consult.consultTitle}">글제목</span>
                    </td>
                </tr>
                <tr>
                    <th>작성일</th>
                    <td>
                    	<span th:text="${#temporals.format(consult.consultDate, 'yyyy-MM-dd hh:mm:ss')}">작성일</span>
                    </td>
                </tr>
				<tr>
					<th>글내용</th>
					<td>
						<textarea>[[ ${consult.consultContent} ]]</textarea>
					</td>
				</tr>
                <tr>
                    <th>품목</th>
                    <td>
						<span th:text="${consult.productCategory}">품목</span>
                    </td>
                </tr>
                <tr>
                    <th colspan="2">
                    	<!-- 글 삭제와 수정은 글쓴 사람과 로그인한 사람과 동일한 경우에만 나타나야 함 -->
						<th:block th:if="${consult.consultWriter == #authentication.name}">     
							<a th:href="@{/cca/update(consultNum=${consult.consultNum}, searchBy=${searchBy}, searchItem=${searchItem})}" class="btn btn-primary">상담글 수정</a>
							<a th:href="@{/cca/delete(consultNum=${consult.consultNum},searchBy=${searchBy}, searchItem=${searchItem})}" class="btn btn-danger">상담글 삭제</a>
						</th:block>
						<th:block th:if="${#authentication.authorities.![authority].contains('ROLE_CCA')}">
							<a th:href="@{/cca/replyWrite(consultNum=${consult.consultNum}, searchBy=${searchBy}, searchItem=${searchItem})}" class="btn btn-danger">답변달기</a>
						</th:block>
                        <a th:href="@{/cca/boardList(searchBy=${searchBy}, searchItem=${searchItem})}" class="btn btn-info">목록</a>
                    </th>

                </tr>
            </table>
			
			<!-- 댓글 목록 부분 -->
			<div id="answer-list" th:if="${#lists.size(replyList) > 0}">
			    <h2>[관세사 답변 목록]</h2>
			    <p th:if="${#lists.size(replyList) > 0}" th:text="'총 ' + ${#lists.size(replyList)} + '개의 답변이 있습니다.'"></p>
			
			    <!-- 각 답변 정보를 담는 테이블 -->
			    <div th:each="reply, status : ${replyList}">
			        <table border="1">
						<input type="hidden" id="replyNum" th:value="${reply.replyNum}">
			            <tr>
			                <th>작성자</th>
			                <td th:text="${reply.replyWriter}">답변자</td>
			            </tr>
			            <tr>
			                <th>답변 작성일</th>
							<td>
								<span th:text="${#temporals.format(reply.replyDate, 'yyyy-MM-dd hh:mm:ss')}">작성일</span>
							</td>
			            </tr>
						
			            <tr>
			                <th>내용</th>
			                <td><textarea th:text="${reply.replyContent}">답변내용</textarea></td>
			            </tr>
			
			            <tr>
			                <td colspan="2">
								<!-- 답변 채택 버튼 -->
								<th:block th:if="${reply.likeCount == 0 &&consult.consultWriter == #authentication.name}">
									<form action="setLike" method="POST">
										<input type="hidden" name="replyNum" th:value="${reply.replyNum}">
										<input type="hidden" name="consultNum" th:value="${consult.consultNum}">
										<input type="hidden" name="searchBy" th:value="${searchBy}">
										<input type="hidden" name="searchItem" th:value="${searchItem}">
										
										<button type="submit" class="chooseAnswerBtn">답변 추천</button>
									</form>
								</th:block>
								<th:block th:if="${reply.replyWriter == #authentication.name}">   
			                    <!-- 답변 수정 버튼 -->
								<a th:href="@{/cca/replyUpdate(replyNum=${reply.replyNum},consultNum=${consult.consultNum}, searchBy=${searchBy}, searchItem=${searchItem})}" class="btn btn-primary">답변 수정</a>
					            <a th:href="@{/cca/replyDelete(replyNum=${reply.replyNum},consultNum=${consult.consultNum},searchBy=${searchBy},searchItem=${searchItem})}" class="btn btn-primary">답변 삭제</a>
								</th:block>	                    
			                </td>
			            </tr>
			        </table>
			    </div>
			</div>

	<!-- footer -->
    <footer class="footer-wave">
        <div class="waves">
            <div class="wave" id="wave1"></div>
            <div class="wave" id="wave2"></div>
            <div class="wave" id="wave3"></div>
            <div class="wave" id="wave4"></div>
        </div>

        <ul class="footer-wave-menu">
            <li class="menu__item"><a class="menu__link" th:href="@{/}">HOME</a></li>
            <li class="menu__item"><a class="menu__link" th:href="@{/news}">무역뉴스</a></li>
            <li class="menu__item"><a class="menu__link" th:href="@{/info/infoList}">FTA정보</a></li>
            <li class="menu__item"><a class="menu__link" th:href="@{/trade/showStat}">무역통계</a></li>
            <li class="menu__item"><a class="menu__link" th:href="@{/cca/boardList}">관세사상담</a></li>

        </ul>
        <p>&copy;2024 HScode Zoom | All Rights Reserved</p>
    </footer>
    <!-- End footer -->

    <!--script-->
    <script>
        const $topBtn = document.querySelector(".moveTopBtn");

        // 버튼 클릭 시 맨 위로 이동
        $topBtn.onclick = () => {
        window.scrollTo({ top: 0, behavior: "smooth" });  
        }
    </script>

    <script src="https://cdn.amcharts.com/lib/5/index.js"></script>
    <script src="https://cdn.amcharts.com/lib/5/xy.js"></script>
    <script src="https://cdn.amcharts.com/lib/5/percent.js"></script>
    <script src="https://cdn.amcharts.com/lib/5/themes/Animated.js"></script>

    <script th:src="@{/script/imexChart.js}"></script>

    <script th:src="@{/assets/js/core/jquery.min.js}" type="text/javascript"></script>
    <script th:src="@{/assets/js/core/popper.min.js}" type="text/javascript"></script>
    <script th:src="@{/assets/js/core/bootstrap.min.js}" type="text/javascript"></script>

    <script th:src="@{/assets/js/plugins/bootstrap-switch.js}"></script>

    <script th:src="@{/assets/js/plugins/nouislider.min.js}" type="text/javascript"></script>

    <script th:src="@{/assets/js/plugins/moment.min.js}"></script>
    <script th:src="@{/assets/js/plugins/bootstrap-datepicker.js}" type="text/javascript"></script>

    <script th:src="@{/assets/js/paper-kit.min.js?v=2.2.0}" type="text/javascript"></script>
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDTTfWur0PDbZWPr7Pmq8K3jiDp0_xUziI"></script>

</body>
</html>
